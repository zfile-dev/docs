import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# 宝塔

## 安装基础环境

:::tip 提示

如已安装 Java 环境（Java 1.8）可跳过此步骤

:::

<Tabs>
<TabItem value="centos" label="Centos">

```bash
yum install -y java-1.8.0-openjdk unzip
```

</TabItem>
<TabItem value="ubuntu" label="Ubuntu">

```bash
apt update
apt install -y openjdk-8-jre-headless unzip
```

</TabItem>
</Tabs>


## 下载项目

下载文件到服务器：https://c.jun6.net/ZFILE/zfile-release.jar


## 宝塔网站配置

![](/img/2022/08/15/72eqJt.jpg)


:::info 提示

如果填写了域名，访问域名即可（记得将域名指向服务），如果使用的是端口，则使用端口访问.

:::


## 配置文件 {#config}

如需要修改配置文件, 请下载配置文件 [`application.properties`](https://c.jun6.net/ZFILE/application.properties) 传到上一步 ZFile 文件所在目录下，命名为 `application.properties`.
然后在**宝塔的 ZFile 配置**中（参考上一步）的表单项 `项目执行命令` 原内容后**增加内容**：

```bash
 --spring.config.location=file:/www/wwwroot/xxx.com/application.properties
# 这里的 /www/wwwroot/xxx.com/application.properties 为你上传到服务器配置文件的路径，注意这行注释不要复制，只复制上面的那一行，注意上移行最前面有一个空格，记得复制（用于和原内容保持一个空格距离）
```


如原来 `项目执行命令` 为：

```bash showLineNumbers
/usr/bin/java -jar -Xmx1024M -Xms256M /path/zfile-release.jar --server.port=7818
```

修改后
```bash showLineNumbers
/usr/bin/java -jar -Xmx1024M -Xms256M /path/zfile-release.jar --server.port=7818 --spring.config.location=file:/path/application.properties
```

> 这里的前半部分 `/usr/bin/java -jar -Xmx1024M -Xms256M /path/zfile-release.jar --server.port=7818` 也是示例，不表示你**宝塔的 ZFile 配置**中的表单项 `项目执行命令` 原内容。


> 注意：如果你使用 9.x 的宝塔，可能会遇到宝塔的一个 bug，导致直链/短链跳转到 127.0.0.1，解决方法是在**宝塔上** 修改这个站点配置文件(不是ZFile配置文件)，将 `proxy_set_header Host 127.0.0.1:$server_port;` 修改为 `proxy_set_header Host $host;`，保存即可。
<img className={'sm:w-6/12 '} src="/img/2024/12/5/baota-fix1.png"></img>
<img className={'sm:w-6/12 '} src="/img/2024/12/5/baota-fix2.png"></img>

## 更新版本

更新步骤如下：

1. 宝塔中停止 ZFile 程序（务必先停止，且尝试访问网页无法访问再继续下面的操作）
2. 重复步骤 [下载项目](#下载项目) 下载最新版本程序，覆盖原来的 `zfile-release.jar` 文件（其实就是先删除之前的，再将新版本程序放到同路径同名）
3. 启动项目，访问验证。（一般启动需要 1-3 分钟，访问如果还是之前的版本，请清除浏览器缓存！）


## 其他设置

宝塔 `nginx` 默认只支持上传最大 `50MB` 的文件，可去以下页面进行设置:

<img className={'sm:w-10/12 '} src="/img/2022/08/16/uxPAXY.png"></img>
<img className={'sm:w-6/12 '} src="/img/2022/08/16/Jx2P2s.png"></img>

## 帮我安装🔍
[技术支持](/support/)
